[gd_scene load_steps=5 format=2]

[ext_resource path="res://Resources/UI/DefaultFont.tres" type="DynamicFont" id=1]
[ext_resource path="res://Server/Server.gdns" type="Script" id=2]

[sub_resource type="GDScript" id=1]

resource_name = "Loading"
script/source = "extends Node

onready var start = OS.get_ticks_msec()

func _ready():
	var args = []
	for arg in OS.get_cmdline_args(): args.append(arg)
	
	if args.has(\"-server\"):
		Com.server = args[args.find(\"-server\") + 1]

func _process(delta):
	if Network.connected:
		if Com.server:
			get_tree().change_scene(\"Scenes/Server.tscn\")
		else:
			get_tree().change_scene(\"Scenes/Login.tscn\")
	
	if OS.get_ticks_msec() > start + 5000:
		$Label.fail = true"
_sections_unfolded = [ "Resource" ]

[sub_resource type="GDScript" id=2]

script/source = "extends Label

const txt = \"Connecting to server\"
var fail = false

func _process(delta):
	if fail:
		text = \"Can't connect to server\\n:(\"
	else:
		var t = OS.get_ticks_msec()
		text = txt + (\".\" if t % 1000 > 250 else \"\") + (\".\" if t % 1000 > 500 else \"\") + (\".\" if t % 1000 > 750 else \"\")"

[node name="Loading" type="Node"]
script = SubResource( 1 )

[node name="Label" type="Label" parent="."]
anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
margin_left = 81.0
margin_top = 255.0
margin_right = 241.0
margin_bottom = 299.0
rect_scale = Vector2( 4, 4 )
rect_pivot_offset = Vector2( 0, 0 )
rect_clip_content = false
mouse_filter = 2
mouse_default_cursor_shape = 0
size_flags_horizontal = 1
size_flags_vertical = 4
custom_fonts/font = ExtResource( 1 )
text = "Connecting to server..."
percent_visible = 1.0
lines_skipped = 0
max_lines_visible = -1
script = SubResource( 2 )
_sections_unfolded = [ "Rect" ]

[node name="Node" type="Node" parent="."]
script = ExtResource( 2 )
_sections_unfolded = [ "Script" ]

